---
- name: Seed MongoDB with data
  hosts: seed
  vars:
    target:
      namespace: nm-dev
    devapp:
      file_path: /tmp/data/devAppsData.json
      collection: devapp
      index: "{ \"searchableText\" : \"text\" }"
    spatial:
      file_path: /tmp/data/devAppsGeoJsonData.json
      collection: spatial
      index: "{ \"properties.searchableText\" : \"text\" }"
  tasks:
    - name: replace params with variables
      template:
        src: "{{ playbook_dir }}/params/mongo-seed/job.j2"
        dest: "{{ playbook_dir }}/params/mongo-seed/job-{{ item.collection }}"
      with_items:
        - "{{ devapp }}"
        - "{{ spatial }}"
    - include_role:
        name: openshift-applier/roles/openshift-applier
